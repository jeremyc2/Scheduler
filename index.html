<title>Scheduler</title>
<link rel="icon" href="favicon.svg" />
<link rel="stylesheet" href="main.css" />
<script>
    var times = {};
    function toggleTimeslot(element) {
        var name = element.getAttribute('name');
        if(times[name] == null) {
            console.log(`Adding ${name} to times array`);
            times[name] = true;
        } else {
            console.log(`Deleting ${name} from times array`);
            delete times[name];
        }
    }
    function populateCounts(schedules) {
        console.log(schedules)
        schedules.forEach(schedule => {
            console.log("User: " + schedule.user);
            Object.keys(schedule.data.available).forEach(time => {
                var checkbox = document.querySelector(`input[type='checkbox'][name='${time}']`);
                var timeslot = checkbox.parentElement;
                var count = timeslot.getAttribute('data-before');
                timeslot.setAttribute('data-before', parseInt(count) + 1);
            });
        });
    }
</script>
<input type="text" id="name" />
<i>Your Name</i>
<h1>What times are you available to meet?</h1>
<div class="container">
    <div class="card">
        <h1>Monday</h1>
        <div data-before="0" data-users class="timeslot tooltip">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 09:00 AM" />
            <span>09:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 10:00 AM" />
            <span>10:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 11:00 AM" />
            <span>11:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 12:00 PM" />
            <span>12:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 01:00 PM" />
            <span>01:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 02:00 PM" />
            <span>02:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 03:00 PM" />
            <span>03:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 04:00 PM" />
            <span>04:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 05:00 PM" />
            <span>05:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 06:00 PM" />
            <span>06:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 07:00 PM" />
            <span>07:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 08:00 PM" />
            <span>08:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 09:00 PM" />
            <span>09:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Monday 10:00 PM" />
            <span>10:00 PM</span>
        </div>
    </div>
    <div class="card">
        <h1>Tuesday</h1>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 09:00 AM" />
            <span>09:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 10:00 AM" />
            <span>10:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 11:00 AM" />
            <span>11:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 12:00 PM" />
            <span>12:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 01:00 PM" />
            <span>01:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 02:00 PM" />
            <span>02:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 03:00 PM" />
            <span>03:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 04:00 PM" />
            <span>04:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 05:00 PM" />
            <span>05:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 06:00 PM" />
            <span>06:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 07:00 PM" />
            <span>07:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 08:00 PM" />
            <span>08:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 09:00 PM" />
            <span>09:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Tuesday 10:00 PM" />
            <span>10:00 PM</span>
        </div>
    </div>
    <div class="card">
        <h1>Wednesday</h1>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 09:00 AM" />
            <span>09:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 10:00 AM" />
            <span>10:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 11:00 AM" />
            <span>11:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 12:00 PM" />
            <span>12:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 01:00 PM" />
            <span>01:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 02:00 PM" />
            <span>02:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 03:00 PM" />
            <span>03:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 04:00 PM" />
            <span>04:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 05:00 PM" />
            <span>05:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 06:00 PM" />
            <span>06:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 07:00 PM" />
            <span>07:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 08:00 PM" />
            <span>08:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 09:00 PM" />
            <span>09:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Wednesday 10:00 PM" />
            <span>10:00 PM</span>
        </div>
    </div>
    <div class="card">
        <h1>Thursday</h1>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 09:00 AM" />
            <span>09:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 10:00 AM" />
            <span>10:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 11:00 AM" />
            <span>11:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 12:00 PM" />
            <span>12:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 01:00 PM" />
            <span>01:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 02:00 PM" />
            <span>02:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 03:00 PM" />
            <span>03:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 04:00 PM" />
            <span>04:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 05:00 PM" />
            <span>05:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 06:00 PM" />
            <span>06:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 07:00 PM" />
            <span>07:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 08:00 PM" />
            <span>08:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 09:00 PM" />
            <span>09:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Thursday 10:00 PM" />
            <span>10:00 PM</span>
        </div>
    </div>
    <div class="card">
        <h1>Friday</h1>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 09:00 AM" />
            <span>09:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 10:00 AM" />
            <span>10:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 11:00 AM" />
            <span>11:00 AM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 12:00 PM" />
            <span>12:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 01:00 PM" />
            <span>01:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 02:00 PM" />
            <span>02:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 03:00 PM" />
            <span>03:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 04:00 PM" />
            <span>04:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 05:00 PM" />
            <span>05:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 06:00 PM" />
            <span>06:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 07:00 PM" />
            <span>07:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 08:00 PM" />
            <span>08:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 09:00 PM" />
            <span>09:00 PM</span>
        </div>
        <div data-before="0" class="timeslot">
            <input type="checkbox" onclick="toggleTimeslot(this)" name="Friday 10:00 PM" />
            <span>10:00 PM</span>
        </div>
    </div>
</div>
<footer>
    <button id="submit">Submit</button>
</footer>


<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-firestore.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyA-Cu7Q9qrRcK3EEwrGtk_5FZg559WBjvY",
    authDomain: "scheduler-86d0a.firebaseapp.com",
    databaseURL: "https://scheduler-86d0a.firebaseio.com",
    projectId: "scheduler-86d0a",
    storageBucket: "scheduler-86d0a.appspot.com",
    messagingSenderId: "344725228463",
    appId: "1:344725228463:web:73cb141b2c9b732db83d5a",
    measurementId: "G-FGFQN5JR51"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>
<script>
    const db = firebase.firestore();

    const schedules = db.collection('schedules');

    document.addEventListener("DOMContentLoaded", () => {
        getSchedules();
    });

    document.querySelector("#submit").addEventListener('click', () => {
        var user = document.querySelector("#name").value;
        if(user != null && user != "")
                addSchedule(user, times);
        else {
            alert("Please fill out your name");
        }
    })

    function addSchedule(user, schedule) {
        schedules.doc(user).set({available: schedule})
            .then(() => {
                console.log('Document wrote successfully');
                alert('Document wrote successfully');
            })
            .catch(error => {
                console.error('Document write failed: ', error);
                alert('Document write failed');
            });
    }

    function getSchedules() {
        return schedules.get().then(snapshot => {
            populateCounts(snapshot.docs.map(doc => {
                return {user: doc.id, data: doc.data()};
            }));
        });
    }

</script>
